/*
 * Copyright (c) 2022-2025 See AUTHORS file.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.github.tommyettinger.ds.test;

import java.io.IOException;
import java.math.BigInteger;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.List;

import com.github.tommyettinger.digital.Base;
import com.github.tommyettinger.digital.Hasher;
import com.github.tommyettinger.ds.IntList;

/**
 * With h = 0:
 * Good multipliers for simpleHash(): [2913, 4637, 6197, 8663, 9865]
 * With h = len:
 * Good multipliers for simpleHash(): [541, 2357, 2733, 3927, 5983, 6123]
 * With h = len, and XOR instead of add:
 * Good multipliers for simpleHash(): [809, 877, 1399, 2083, 3185, 3529, 4397, 4733, 4873, 5273, 9925]
 * Good multipliers for simpleHash(): [809 (P), 877 (P), 1399 (P), 2083 (P), 3185, 3529 (P), 4397 (P), 4733 (P), 4873, 5273 (P), 9925, 10471, 11481, 11487, 12381, 14069, 15519, 21053, 23619, 23695, 24093, 24185, 24425, 29995, 30013 (P), 32785, 33659, 36043, 36271, 36549, 38467, 38497, 40541, 42421, 42691, 42769, 43993, 49357, 49693, 51767 (P), 54587, 54877 (P), 56475, 56923 (P), 58703, 59043, 60225, 60511, 61663, 62455, 64825, 65661, 66849, 67545, 71249 (P), 71695, 71783, 71949, 72553, 73865, 74855, 82507 (P), 83267 (P), 83601, 86753 (P), 87433 (P), 87699, 93913 (P), 94621 (P), 96633, 98913, 103763, 107527, 108187 (P), 110801, 113389, 114865, 115205, 117321, 117827, 118061 (P), 118687 (P), 118893, 118895, 120051, 126479, 126647, 127067, 127137, 127839, 128025, 128517, 130271, 132013, 132435, 134115, 134577, 137367, 137571, 138697, 139051, 139943 (P), 140459, 140587 (P), 141297, 141395, 141643, 142015, 142511, 144363, 144791 (P), 145013, 145109 (P), 145483, 148873 (P), 149753, 149959, 150737, 151519, 152061, 152663, 153695, 155833 (P), 156989, 159881, 162081, 162631, 163283, 163365, 163373, 165081, 171085, 174033, 175701, 175787, 176345, 177589 (P), 178975, 180257, 182357, 182555, 182837, 183949 (P), 187179, 189637, 191613, 196557, 196797, 197215, 198583, 199323, 199925, 200077, 203657 (P), 204267, 205925, 207509 (P), 207799 (P), 213217 (P), 213793, 214827, 216611, 223651, 228127 (P), 228407, 229205, 230609, 234445, 237811, 245941 (P), 246695, 248987 (P), 250051 (P), 250475, 252703, 252907, 253483, 255191 (P), 255425, 255891, 257519 (P), 258385, 262025, 262731, 265425, 265555, 268245, 275617, 275941 (P), 280365, 282557, 286383, 290087, 290627 (P), 290831, 291051, 293017, 293859, 294389, 295861 (P), 297115, 297271, 299731 (P), 299859, 301131, 301647, 304239, 304863, 306713, 308721, 308827 (P), 310635, 312711, 312787, 313223, 316405, 318837, 319055, 319585, 321509 (P), 322565, 322865, 323895, 326583, 329425, 329845, 331023, 331201, 331919, 338493, 338747 (P), 339759, 341079, 342455, 343189, 344055, 347305, 348097 (P), 348975, 350373, 350663 (P), 352745, 352749, 352795, 353039, 354527, 354757, 354785, 355613, 361743, 363497 (P), 364495, 366091, 366297, 367069 (P), 368335, 369177, 370119, 372043, 372191, 373025, 374425, 374645, 374709, 377405, 378565, 378967 (P), 379221, 379285, 382163 (P), 382649 (P), 383043, 384871, 387349, 391137, 391857, 392099 (P), 392185, 393081, 394579 (P), 395155, 395367, 395733, 395965, 396201, 399519, 400539, 402001, 402147, 406167, 406453, 408089, 410731 (P), 411665, 411949, 412073 (P), 414859, 416573 (P), 418377, 419559, 419659, 419829, 420091, 420375, 421865, 422565, 424515, 424727 (P), 424733, 427447 (P), 427715, 429355, 431087, 432299, 432329, 433903, 435225, 435341, 435619 (P), 436605, 436639, 437527 (P), 439335, 439655, 440943, 442581, 444721, 445711, 448999 (P), 451933 (P), 453807, 455705, 456005, 456235, 456599, 456909, 457353, 458975, 459533, 460285, 462449, 463209, 466061 (P), 466731, 468729, 472141, 474317, 475671, 477231, 479129, 481523, 482967, 482997, 485023, 485787, 485849, 486179 (P), 488549, 489173, 489253, 489853, 490701, 491823, 493517, 495587 (P), 496071, 496423, 498223, 499491, 500957 (P), 501873, 502533, 505427, 505697, 506503, 507317 (P), 507629, 509189, 511107, 511447 (P), 513625, 513875, 514171, 515157, 515485, 515745, 517163, 517817 (P), 518513, 519839, 520315, 521355, 522445, 524119 (P), 524267, 527565, 529797, 531361, 534155, 535659, 539749, 545485, 547111, 547421, 547741 (P), 548749 (P), 549051, 550459, 551959 (P), 551993, 553735, 556465, 557329 (P), 558497 (P), 559445, 562465, 562799, 563145, 563757, 564453, 565305, 565341, 565437, 566583, 566635, 568273 (P), 569423 (P), 572373, 573383 (P), 574041, 574153, 575583, 575819, 577541, 577819, 578423, 578741 (P), 580247, 583063, 583229 (P), 587939, 588737 (P), 591771, 593607, 595191, 596383, 596589, 597089, 597793, 597915, 597935, 599263, 599357, 600369, 601273, 601433, 603699, 609421 (P), 609547, 611539, 611851, 612501, 613587, 615023, 616279, 616695, 617825, 620063, 620949, 625329, 626521, 627883, 628345, 628791, 629901, 632029 (P), 632111, 634043, 635017, 635969 (P), 637067 (P), 638235, 638533, 639773, 641137, 644461, 646089, 646281, 646475, 649997, 651159, 651997 (P), 652525, 654201, 656029, 658955, 659447, 661575, 662949, 665977, 666333, 666407, 666671 (P), 666707 (P), 667315, 670181, 671685, 671799, 672819, 673255, 673785, 673789, 674035, 674659, 675043, 676473, 677197, 678031, 679223 (P), 680311, 681153, 681537, 683089, 683637, 684551, 684873, 684973 (P), 685029, 685041, 685281, 687133, 687621, 688957 (P), 689275, 690563, 691393, 694097, 701709, 701987, 703523, 704447 (P), 704827, 709405, 712151, 713033, 714785, 716069, 716761, 717421, 717637, 720033, 720441, 720701, 721799, 721813, 722489 (P), 724797, 730877, 731723, 735701, 735937 (P), 737155, 738979, 740483 (P), 742641, 745269, 745819, 747237, 748743, 750873, 751335, 751435, 752427, 752999, 753755, 753831, 755755, 758667, 758795, 761495, 761923, 762507, 766565, 767761 (P), 768099, 768725, 769395, 773045, 773403, 773973, 774251, 775311, 776693 (P), 777979 (P), 778949, 780733 (P), 780833 (P), 783311, 785203 (P), 785349, 786631, 787471, 792919 (P), 792947, 794947, 796717, 797101, 799345, 800009, 801179 (P), 801453, 802189 (P), 803641, 805135, 805785, 807031, 807409 (P), 807929, 811353, 811531, 813549, 816567, 816729, 817519 (P), 818379, 819285, 819671, 823459, 824329, 824607, 826127, 827729, 830083, 830973, 831247, 831943, 838043 (P), 840187 (P), 841743, 847599, 848873, 849577, 851835, 852291, 853009, 854559, 854981, 855165, 855797, 856353, 856489, 857609, 861099, 867419, 867473, 869621, 871921, 873777, 874817, 877917, 878111, 878231, 880327, 881123, 881429, 882877 (P), 883609, 883793, 888525, 889263, 890613, 890823, 891835, 892215, 892339, 893551, 893743 (P), 896999, 899941, 902539, 903335, 903337 (P), 905137 (P), 905917 (P), 906441, 907423, 907929, 908497, 910363, 910431, 910629, 913541, 915395, 915989, 916907 (P), 918637, 919839, 921007 (P), 921737 (P), 922297, 923385, 923727, 926127, 926919, 927915, 931747 (P), 932117 (P), 933863, 934613 (P), 936367, 938847, 939041, 944413, 946825, 948733, 949417, 949549, 949973 (P), 950959 (P), 952783, 955027, 956969, 958177, 958571, 960523 (P), 960819, 961117 (P), 965197 (P), 965829, 967097, 968025, 970293, 972093, 972451, 972629, 977529, 978615, 979257, 981703 (P), 982457, 984549, 985147, 988583 (P), 989577, 992683, 994159, 995471 (P), 996533, 997677, 998789, 998839 (P), 999361, 999717, 999911, 1001035, 1002139, 1002277, 1005117, 1005149, 1005773, 1006739 (P), 1010621, 1014009, 1016049, 1017865, 1018925, 1021237, 1023349, 1023911, 1024085, 1025099 (P), 1025479, 1025639, 1027023, 1027671, 1027907, 1031123, 1033941, 1034005, 1034465, 1035105, 1035387, 1036173, 1036185, 1036293, 1036511, 1036675, 1037011, 1037731, 1040219 (P), 1041195, 1043923 (P), 1043997, 1044785, 1049167, 1049627, 1050385, 1057727, 1058023, 1058987, 1058991, 1059773, 1060829, 1062523, 1063163, 1063739 (P), 1066559, 1068617, 1069319, 1072313, 1072893, 1073903, 1073973, 1074587, 1077649, 1079491, 1081165, 1082309, 1082941, 1083217, 1085043, 1086115, 1086311, 1088799, 1089309, 1090019, 1091651, 1092059 (P), 1094317, 1097379, 1098613 (P), 1099599, 1101743 (P), 1102305, 1103645, 1105603 (P), 1106653 (P), 1107563, 1112093 (P), 1112275, 1112293, 1113001, 1113705, 1115951, 1116487, 1121387 (P), 1121867 (P), 1122351, 1125365, 1126209, 1126365, 1129809, 1130479, 1132427, 1135445, 1135855, 1136615, 1138115, 1138739, 1139783, 1141159, 1141471, 1142291, 1142633 (P), 1142771, 1144303, 1146155, 1147507 (P), 1147545, 1150363 (P), 1151341, 1151509, 1153241 (P), 1155129, 1156667, 1160117, 1160697, 1161913, 1164597, 1165821, 1166303, 1167071, 1167209 (P), 1167465, 1167875, 1168413, 1168531, 1170143, 1171049, 1171123 (P), 1171921 (P), 1172049, 1172561, 1172661, 1174885, 1176727, 1178205, 1178921 (P), 1179191, 1179337 (P), 1179567, 1179887, 1180741, 1181021, 1181251, 1182781 (P), 1183541 (P), 1184081 (P), 1185465, 1185745, 1186417, 1186833, 1189793, 1189795, 1191401, 1192055, 1193723, 1194653, 1194759, 1195789, 1198989, 1201135, 1205237, 1205473 (P), 1206801, 1207517, 1208515, 1208697, 1210009, 1210279, 1211403, 1212027, 1213091, 1214925, 1216107, 1217135, 1217271, 1218655, 1219879 (P), 1220059, 1220511, 1221181, 1222093, 1222457, 1222563, 1225049, 1228191, 1228397 (P), 1228521, 1229155, 1229699, 1234033, 1234345, 1234503, 1241241, 1242147, 1242929 (P), 1243219, 1245061, 1248581, 1252139, 1255095, 1257189, 1263197, 1264073, 1264933 (P), 1266823, 1269829, 1273165, 1275063, 1279033, 1279853 (P), 1281119, 1285315, 1285697, 1287659, 1287977, 1288089, 1288391, 1288889, 1290885, 1291097, 1291247, 1292931, 1293955, 1295851, 1296279, 1297515, 1297775, 1297899, 1298733, 1301521, 1301547, 1302891, 1303651, 1304997, 1305811, 1305869 (P), 1306413, 1308293, 1311709, 1312885, 1312905, 1316169, 1317839 (P), 1318615, 1319265, 1320177, 1321105, 1321157 (P), 1322743 (P), 1323809, 1323945, 1324455, 1325711, 1326127, 1327177, 1330537, 1331051 (P), 1331097, 1333769, 1340067, 1340907, 1343711, 1344919, 1346051, 1346295, 1348115, 1348147, 1350723, 1350943, 1351111 (P), 1354919, 1361171, 1361363 (P), 1362213, 1363299, 1365297, 1373885, 1379801 (P), 1381613 (P), 1384113, 1384173, 1388675, 1388735, 1389947, 1393177, 1394287, 1394639, 1395461, 1396337, 1396591, 1397365, 1398357, 1398427 (P), 1399353, 1399359, 1400451, 1401703 (P), 1402621, 1402629, 1404357, 1404475, 1405019, 1406307, 1407175, 1407603, 1408063, 1409107, 1409311 (P), 1410803 (P), 1412063, 1413057, 1414153, 1414315, 1414651, 1414787, 1416207, 1416385, 1419523, 1420253 (P), 1420443, 1420853, 1421261, 1422837, 1422995, 1423249, 1424279, 1425353, 1425399, 1427101, 1427369, 1427609, 1429605, 1429705, 1431815, 1432189, 1432359, 1432865, 1433401, 1433421, 1434657, 1435783 (P), 1436135, 1436343, 1437245, 1437425, 1438141, 1438517 (P), 1438895, 1439095, 1444399, 1444449, 1446327, 1446943, 1448237, 1449521 (P), 1449717, 1450571 (P), 1456295, 1456963 (P), 1457247, 1457289, 1458163, 1461359 (P), 1462009 (P), 1463849, 1463911 (P), 1465757, 1472043, 1472523, 1475765, 1476699, 1479773 (P), 1480353, 1480507, 1483291, 1486241 (P), 1486663, 1487465, 1487983, 1488427 (P), 1488749 (P), 1488857 (P), 1489155, 1496775, 1497185, 1497591, 1498035, 1498163, 1498181, 1498403 (P), 1498825, 1498845, 1499429 (P), 1500767 (P), 1503351, 1503905, 1510617, 1511197, 1512093, 1513413, 1516087 (P), 1517197, 1520017, 1521479 (P), 1521705, 1524171, 1524499, 1526801, 1528315, 1528441 (P), 1531303 (P), 1533423, 1534145, 1534651, 1535185, 1538671, 1543697, 1544969, 1546057 (P), 1549885, 1550503 (P), 1551189, 1551283, 1551689, 1553587, 1554709, 1558147, 1558487, 1558939 (P), 1559013, 1561065, 1561759 (P), 1562007, 1562775, 1564599, 1564925, 1567461, 1567693 (P), 1568171, 1570247, 1570901, 1572629 (P), 1573941, 1575535, 1576739, 1578821 (P), 1579165, 1581197, 1582085, 1582175, 1585643, 1587541, 1587689, 1589211, 1589745, 1590307, 1593107, 1593123, 1594615, 1595245, 1595911, 1596531, 1596707, 1596805, 1598565, 1600483 (P), 1600643, 1601123 (P), 1609957, 1611467, 1612347, 1613043, 1613649, 1614035, 1616567, 1617603, 1618513, 1620213, 1620281, 1620383, 1621513, 1622705, 1622801, 1624031, 1624339, 1625423, 1626489, 1627361 (P), 1628561, 1629999, 1631543 (P), 1634171, 1638597, 1640195, 1640287, 1640405, 1645337 (P), 1646475, 1647631, 1649933, 1651021, 1651165, 1654983, 1656119 (P), 1656499, 1658089 (P), 1658833, 1659861, 1660565, 1662101, 1662173, 1664889, 1665489, 1665845, 1666005, 1666753, 1668249, 1669591, 1678115, 1678557, 1679763, 1680091, 1681695, 1682043, 1683111, 1684805, 1685321, 1686745, 1689655, 1691095, 1694617, 1696103, 1701251, 1705879, 1710821, 1711437, 1712141 (P), 1714603, 1717513, 1717599, 1719011, 1721387, 1722329, 1723281, 1724237, 1726383, 1726455, 1727721, 1728241, 1729205, 1729253 (P), 1730301, 1731167 (P), 1731287 (P), 1731427, 1733269, 1734323, 1736713, 1737361, 1737867, 1737915, 1738771, 1739307, 1739693 (P), 1741581, 1742865, 1747623, 1747915, 1748407 (P), 1749977, 1750351 (P), 1751203, 1754371, 1755407, 1756151, 1759405, 1762349, 1763373, 1764341, 1765653, 1768013, 1768055, 1770253, 1770395, 1772663, 1774241, 1778185, 1778243 (P), 1778457, 1778841, 1781233 (P), 1784227 (P), 1790315, 1790445, 1793387 (P), 1793495, 1794017 (P), 1795227, 1795253, 1797423, 1798121, 1799489, 1800113, 1801577 (P), 1801645, 1807373, 1808519, 1808943, 1813525, 1813735, 1816767, 1817037, 1817289, 1817977, 1820751, 1822107, 1825125, 1825649, 1825747, 1827403, 1827781, 1829125, 1830411, 1830759, 1831173, 1831831 (P), 1831931, 1832041, 1834575, 1834891, 1841517, 1841647, 1842631, 1842927, 1845683, 1846241 (P), 1846607, 1850507, 1852041, 1853129, 1853839, 1854147, 1854313 (P), 1854857, 1856447, 1856629, 1860533 (P), 1861559, 1863755, 1869539, 1871893, 1873465, 1875347, 1877837, 1878123, 1878135, 1881991, 1882171 (P), 1882297, 1889507, 1893259, 1894033 (P), 1894815, 1895191 (P), 1895677, 1896181, 1896675, 1900255, 1901487, 1902171, 1905829, 1905861, 1909871, 1910289, 1910865, 1911431, 1912869, 1915331, 1916317, 1917345, 1918961, 1919865, 1919955, 1921533, 1922087, 1922997, 1925319, 1927225, 1928497, 1930259 (P), 1931143 (P), 1932257, 1933451, 1933551, 1934943, 1940641, 1942609, 1947169, 1947189, 1950041, 1951183, 1954577, 1955047 (P), 1956455, 1961183, 1961325, 1963835, 1964527, 1966725, 1967577, 1968147, 1971149 (P), 1972085, 1973809, 1974419, 1974909, 1980897, 1982547, 1985833, 1986903, 1987367, 1988337, 1988687, 1990789, 1992291, 1992601, 1993235, 1993519, 1995637, 1995943, 1997213 (P), 1997735, 1998299, 1998437, 2001433, 2002371, 2003639, 2004509, 2007405, 2008877, 2011123 (P), 2011973 (P), 2013141, 2014387, 2015055, 2015881, 2015883, 2016229, 2017653, 2017771, 2017943, 2018101, 2018833, 2021473, 2023361, 2023857, 2025139, 2025529, 2026237, 2027203, 2027693, 2028805, 2031357, 2033539, 2034667, 2037755, 2038543, 2039671 (P), 2039987, 2041205, 2042201, 2042693, 2044041, 2047181 (P), 2047451, 2051481, 2052637, 2054849 (P), 2055333, 2055717, 2057587, 2057981 (P), 2058289, 2058411, 2058641, 2058651, 2059755, 2064957, 2065127, 2067785, 2068807, 2070733, 2070761, 2071057, 2071299, 2071323, 2071781 (P), 2073849, 2080941, 2081915, 2082243, 2083471, 2083933, 2086087, 2086093, 2086411, 2088505, 2090019, 2090621, 2091125, 2093045, 2094169, 2096419] * <br>
 * Good seeds for hash(): [14, 276, 1562, 2327, 2713, 2750, 2765, 2785]
 * <br>
 * Good seeds for hashBulk(): [17, 564, 1127, 1663, 1859, 2269, 4345, 4827, 4919]
 */
public class WordListStats {
	public static class SimpleHasher {
		public final int mul;
		public SimpleHasher(int seed){
			mul = seed * 2 + 1;
		}
		public int simpleHash(String s) {
			final int len = s.length();
			int h = len;
			for (int i = 0; i < len; i++) {
				h = h * mul ^ s.charAt(i);
			}
			return h;
		}
	}

	public static void main(String[] args) throws IOException {
		final List<String> words = Files.readAllLines(Paths.get("src/test/resources/word_list.txt"));
		int wordCount = words.size();
		System.out.printf("Number of words   : %d\n", wordCount);
		StringBuilder goodSimpleHashMultipliers = new StringBuilder();
		for (int i = 1; i < 0x100000; i++) {
			SimpleHasher op = new SimpleHasher(i);
			long collisionCount = wordCount - words.parallelStream().mapToInt(op::simpleHash).distinct().count();
			if(collisionCount == 0) {
				boolean prime = BigInteger.valueOf(op.mul).isProbablePrime(9);
				System.out.print("SimpleHasher.simpleHash() with mul " + op.mul
					+ " 0x" + Integer.toHexString(op.mul)
				);
				System.out.println(prime ? " (PRIME!)" : "");
				goodSimpleHashMultipliers.append(op.mul);
//				goodSimpleHashMultipliers.append(" 0x");
//				Base.BASE16.appendSigned(goodSimpleHashMultipliers, op.mul);
				if(prime)
					goodSimpleHashMultipliers.append(" (P)");
				goodSimpleHashMultipliers.append(", ");
			}
		}
		System.out.println("Good multipliers for simpleHash(): [" + goodSimpleHashMultipliers + "]");

//		IntList goodHashSeeds = new IntList();
//		for (int i = 0; i < 5000; i++) {
//			Hasher op = new Hasher(i);
//			long collisionCount = wordCount - words.parallelStream().mapToInt(op::hash).distinct().count();
//			if(collisionCount == 0) {
//				System.out.println("Hasher.hash() with seed " + i);
//				goodHashSeeds.add(i);
//			}
//		}
//		System.out.println("Good seeds for hash(): " + goodHashSeeds);
//
//		IntList goodHashBulkSeeds = new IntList();
//		for (int i = 0; i < 5000; i++) {
//			Hasher op = new Hasher(i);
//			long collisionCount = wordCount - words.parallelStream().mapToInt(op::hashBulk).distinct().count();
//			if(collisionCount == 0) {
//				System.out.println("Hasher.hashBulk() with seed " + i);
//				goodHashBulkSeeds.add(i);
//			}
//		}
//		System.out.println("Good seeds for hashBulk(): " + goodHashBulkSeeds);
	}
}
